<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeRoute AI - Intelligent API Gateway</title>
    <link rel="stylesheet" href="styles-solid.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Welcome Modal -->
    <div id="welcomeModal" class="modal">
        <div class="modal-content welcome-modal">
            <div class="welcome-header">
                <div class="welcome-icon">üõ°Ô∏è</div>
                <h1>Welcome to SafeRoute AI</h1>
                <p class="welcome-subtitle">Your Intelligent API Gateway for Fraud Detection</p>
            </div>
            <div class="welcome-body">
                <div class="welcome-section">
                    <h3>üéØ What is SafeRoute AI?</h3>
                    <p>SafeRoute AI is an intelligent API gateway that protects your fintech platform by detecting fraud patterns in real-time using advanced AI algorithms.</p>
                </div>
                <div class="welcome-section">
                    <h3>‚ú® Key Features</h3>
                    <ul class="feature-list">
                        <li><strong>Real-time Fraud Detection:</strong> AI analyzes every request instantly</li>
                        <li><strong>Intelligent Routing:</strong> Automatically blocks or allows traffic based on risk</li>
                        <li><strong>Complete Visibility:</strong> Monitor all API traffic and decisions</li>
                        <li><strong>Interactive Testing:</strong> Try different scenarios with one click</li>
                    </ul>
                </div>
                <div class="welcome-section">
                    <h3>üöÄ Quick Start Guide</h3>
                    <ol class="quick-start-list">
                        <li>Explore the <strong>Dashboard</strong> to see real-time metrics</li>
                        <li>Use the <strong>Test Panel</strong> on the left to send API requests</li>
                        <li>Try <strong>Demo Scenarios</strong> from the header menu</li>
                        <li>Check the <strong>Live Stream</strong> to watch requests flow through</li>
                    </ol>
                </div>
                <div class="welcome-tips">
                    <p>üí° <strong>Tip:</strong> Use the header buttons to access all features quickly!</p>
                </div>
            </div>
            <div class="welcome-footer">
                <button id="startTourBtn" class="btn btn-secondary">Take a Tour</button>
                <button id="closeWelcomeBtn" class="btn btn-primary">Get Started</button>
            </div>
        </div>
    </div>

    <!-- Help Panel -->
    <div id="helpPanel" class="help-panel">
        <button id="helpToggle" class="help-toggle" title="Need help? Click for assistance">
            <span class="help-icon">?</span>
        </button>
        <div id="helpContent" class="help-content">
            <div class="help-header">
                <h3>Context Help</h3>
                <button id="closeHelp" class="close-help">√ó</button>
            </div>
            <div id="helpText" class="help-text">
                <p><strong>Welcome!</strong> This panel provides context-sensitive help based on what you're viewing.</p>
                <p>Hover over buttons and features to see tooltips, or click elements to get detailed guidance.</p>
            </div>
        </div>
    </div>

    <!-- Reorganized Header - Black Background -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <div class="logo">
                    <span class="logo-icon">üõ°Ô∏è</span>
                    <span class="logo-text">SafeRoute AI</span>
                </div>
            </div>
            
            <div class="header-right">
                <!-- Health Check Button -->
                <button id="healthCheckBtn" class="header-button" title="Check health status of all backend services">
                    ‚ù§Ô∏è Health Check
                </button>
                
                <!-- Settings Dropdown -->
                <div class="nav-item">
                    <button class="header-button">‚öôÔ∏è Settings</button>
                    <div class="nav-dropdown">
                        <div class="nav-dropdown-item" onclick="document.getElementById('autoRefreshToggle').click()">
                            <span class="icon">üîÑ</span>
                            <div>
                                <div class="nav-dropdown-title">Auto-Refresh</div>
                                <div class="nav-dropdown-desc">Toggle automatic dashboard updates</div>
                            </div>
                        </div>
                        <div class="nav-dropdown-item" onclick="document.getElementById('soundAlertsToggle').click()">
                            <span class="icon">üîî</span>
                            <div>
                                <div class="nav-dropdown-title">Sound Alerts</div>
                                <div class="nav-dropdown-desc">Enable audio notifications</div>
                            </div>
                        </div>
                        <div class="nav-dropdown-item" onclick="document.getElementById('clearLogsBtn').click()">
                            <span class="icon">üóëÔ∏è</span>
                            <div>
                                <div class="nav-dropdown-title">Clear Logs</div>
                                <div class="nav-dropdown-desc">Remove all request logs</div>
                            </div>
                        </div>
                        <div class="nav-dropdown-item" onclick="document.getElementById('resetMetricsBtn').click()">
                            <span class="icon">‚Ü∫</span>
                            <div>
                                <div class="nav-dropdown-title">Reset Metrics</div>
                                <div class="nav-dropdown-desc">Clear all statistics</div>
                            </div>
                        </div>
                        <div class="nav-dropdown-item" onclick="document.getElementById('exportDataBtn').click()">
                            <span class="icon">üì•</span>
                            <div>
                                <div class="nav-dropdown-title">Export Data</div>
                                <div class="nav-dropdown-desc">Download metrics and logs</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Demo Scenarios Dropdown -->
                <div class="nav-item">
                    <button class="header-button primary">üéØ Demo Scenarios</button>
                    <div class="nav-dropdown">
                        <div class="nav-dropdown-item" onclick="executeScenario('normal')">
                            <span class="icon">üü¢</span>
                            <div>
                                <div class="nav-dropdown-title">Normal Transaction</div>
                                <div class="nav-dropdown-desc">Typical payment, low risk</div>
                            </div>
                        </div>
                        <div class="nav-dropdown-item" onclick="executeScenario('rapid-fire')">
                            <span class="icon">üî¥</span>
                            <div>
                                <div class="nav-dropdown-title">Rapid Fire Attack</div>
                                <div class="nav-dropdown-desc">30 requests in 60 seconds</div>
                            </div>
                        </div>
                        <div class="nav-dropdown-item" onclick="executeScenario('high-value')">
                            <span class="icon">üü°</span>
                            <div>
                                <div class="nav-dropdown-title">High-Value Anomaly</div>
                                <div class="nav-dropdown-desc">Payment 10x above average</div>
                            </div>
                        </div>
                        <div class="nav-dropdown-item" onclick="executeScenario('off-hours')">
                            <span class="icon">üü°</span>
                            <div>
                                <div class="nav-dropdown-title">Off-Hours Activity</div>
                                <div class="nav-dropdown-desc">Large payment at 2 AM</div>
                            </div>
                        </div>
                        <div class="nav-dropdown-item" onclick="executeScenario('combined')">
                            <span class="icon">üî¥</span>
                            <div>
                                <div class="nav-dropdown-title">Combined Threat</div>
                                <div class="nav-dropdown-desc">Multiple fraud indicators</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Simplified Sidebar - Only API Gateway Section -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <h3 class="sidebar-title">Test API Gateway</h3>
                <div class="test-panel">
                    <label class="form-label">Select Endpoint:</label>
                    <select id="endpointSelect" class="form-select" title="Choose which API endpoint to test">
                        <option value="/api/payments">POST /api/payments</option>
                        <option value="/api/accounts/:accountId">GET /api/accounts/:accountId</option>
                        <option value="/api/payments/:transactionId">GET /api/payments/:transactionId</option>
                        <option value="/api/verify/identity">POST /api/verify/identity</option>
                    </select>

                    <label class="form-label">Request Body (JSON):</label>
                    <textarea id="requestBody" class="form-textarea" rows="8" title="Edit the JSON payload for your test request"></textarea>

                    <button id="sendRequestBtn" class="btn btn-primary btn-block" title="Send this request through the API Gateway">
                        <span class="icon">üöÄ</span> Send Request
                    </button>

                    <div id="responseDisplay" class="response-display"></div>
                </div>
            </div>

            <!-- Hidden buttons for programmatic access -->
            <div style="display: none;">
                <button id="clearLogsBtn"></button>
                <button id="resetMetricsBtn"></button>
                <button id="exportDataBtn"></button>
                <input type="checkbox" id="autoRefreshToggle" checked>
                <input type="checkbox" id="soundAlertsToggle">
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <section class="metrics-section">
                <h2 class="section-title">Traffic Summary</h2>
                <div class="metrics-grid">
                    <div class="metric-card" title="Total number of requests processed by the gateway">
                        <div class="metric-icon">üìä</div>
                        <div class="metric-content">
                            <div class="metric-label">Total Requests</div>
                            <div class="metric-value" id="totalRequests">0</div>
                            <div class="metric-change" id="totalChange">‚Äî</div>
                        </div>
                    </div>
                    <div class="metric-card" title="Requests that completed successfully (2xx status)">
                        <div class="metric-icon success">‚úì</div>
                        <div class="metric-content">
                            <div class="metric-label">Success</div>
                            <div class="metric-value" id="successRequests">0</div>
                            <div class="metric-change success" id="successRate">0%</div>
                        </div>
                    </div>
                    <div class="metric-card" title="Requests blocked by AI fraud detection">
                        <div class="metric-icon danger">‚äó</div>
                        <div class="metric-content">
                            <div class="metric-label">Blocked</div>
                            <div class="metric-value" id="blockedRequests">0</div>
                            <div class="metric-change danger" id="blockedRate">0%</div>
                        </div>
                    </div>
                    <div class="metric-card" title="Average time to process and route requests">
                        <div class="metric-icon">‚ö°</div>
                        <div class="metric-content">
                            <div class="metric-label">Avg Response</div>
                            <div class="metric-value" id="avgResponse">0ms</div>
                            <div class="metric-change" id="responseChange">‚Äî</div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="risk-section">
                <h2 class="section-title">Risk Distribution</h2>
                <div class="risk-grid">
                    <div class="risk-card normal" title="Requests with risk score 0-30 (safe to process)">
                        <div class="risk-header">
                            <span class="risk-icon">üü¢</span>
                            <span class="risk-label">Normal</span>
                        </div>
                        <div class="risk-value" id="normalCount">0</div>
                        <div class="risk-percentage" id="normalPercent">0%</div>
                        <div class="risk-bar">
                            <div class="risk-bar-fill normal" id="normalBar"></div>
                        </div>
                    </div>
                    <div class="risk-card suspicious" title="Requests with risk score 31-69 (monitor closely)">
                        <div class="risk-header">
                            <span class="risk-icon">üü°</span>
                            <span class="risk-label">Suspicious</span>
                        </div>
                        <div class="risk-value" id="suspiciousCount">0</div>
                        <div class="risk-percentage" id="suspiciousPercent">0%</div>
                        <div class="risk-bar">
                            <div class="risk-bar-fill suspicious" id="suspiciousBar"></div>
                        </div>
                    </div>
                    <div class="risk-card high-risk" title="Requests with risk score 70-100 (blocked or requires verification)">
                        <div class="risk-header">
                            <span class="risk-icon">üî¥</span>
                            <span class="risk-label">High Risk</span>
                        </div>
                        <div class="risk-value" id="highRiskCount">0</div>
                        <div class="risk-percentage" id="highRiskPercent">0%</div>
                        <div class="risk-bar">
                            <div class="risk-bar-fill high-risk" id="highRiskBar"></div>
                        </div>
                    </div>
                    <div class="risk-card average" title="Average risk score across all requests">
                        <div class="risk-header">
                            <span class="risk-icon">üìà</span>
                            <span class="risk-label">Avg Risk Score</span>
                        </div>
                        <div class="risk-value" id="avgRiskScore">0</div>
                        <div class="risk-percentage" id="avgRiskLevel">Low Risk</div>
                    </div>
                </div>
            </section>

            <section class="charts-section">
                <h2 class="section-title">Fraud Detection Patterns</h2>
                <div style="height: 300px;">
                    <canvas id="fraudPatternsChart"></canvas>
                </div>
            </section>

            <section class="logs-section">
                <h2 class="section-title">Live Request Stream</h2>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <select id="logFilterSelect" class="form-select" style="width: 200px;" title="Filter requests by risk level">
                        <option value="all">All Requests</option>
                        <option value="NORMAL">Normal Only</option>
                        <option value="SUSPICIOUS">Suspicious Only</option>
                        <option value="HIGH_RISK">High Risk Only</option>
                    </select>
                    <button id="pauseLogsBtn" class="btn btn-secondary" title="Pause live log updates">
                        <span class="icon">‚è∏Ô∏è</span> Pause
                    </button>
                </div>
                <div id="logsContainer" style="max-height: 500px; overflow-y: auto;">
                    <div class="empty-state">
                        <div class="empty-icon">üì≠</div>
                        <h3>No Requests Yet</h3>
                        <p>Send a test request or run a demo scenario to see activity here.</p>
                    </div>
                </div>
            </section>

            <section class="analysis-section">
                <h2 class="section-title">AI Analysis & Insights</h2>
                <div id="analysisContainer">
                    <div class="empty-state">
                        <div class="empty-icon">‚úÖ</div>
                        <h3>All Systems Normal</h3>
                        <p>No anomalies or threats detected. The AI is monitoring all traffic and will alert you to any suspicious patterns.</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Detail Modal -->
    <div id="detailModal" class="modal">
        <div class="modal-content detail-modal">
            <div class="modal-header">
                <h2>Request Details</h2>
                <button class="modal-close" id="closeDetailModal">√ó</button>
            </div>
            <div class="modal-body" id="detailModalBody"></div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>